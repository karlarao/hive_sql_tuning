{"STAGE PLANS":{"Stage-1":{"Tez":{"DagId:":"sryerama_20180206193038_b329c5fb-8ab9-49d7-8ca6-dcfa3fa42a4b:1","Vertices:":{"Reducer 2":{"Reduce Operator Tree:":{"Merge Join Operator":{"keys:":{"1":"_col0 (type: decimal(19,0)), _col1 (type: int)","0":"CAST( id_prem AS decimal(19,0)) (type: decimal(19,0)), id_spt (type: int)"},"outputColumnNames:":["_col1","_col2","_col5","_col7","_col16","_col17"],"children":{"Reduce Output Operator":{"Map-reduce partition columns:":"_col7 (type: varchar(20)), _col5 (type: date), _col1 (type: bigint), _col2 (type: int)","sort order:":"++++","value expressions:":"_col16 (type: decimal(9,0)), _col17 (type: int)","Statistics:":"Num rows: 806213 Data size: 93520735 Basic stats: COMPLETE Column stats: NONE","key expressions:":"_col7 (type: varchar(20)), _col5 (type: date), _col1 (type: bigint), _col2 (type: int)"}},"Statistics:":"Num rows: 806213 Data size: 93520735 Basic stats: COMPLETE Column stats: NONE","condition map:":[{"":"Inner Join 0 to 1"}]}}},"Reducer 3":{"Reduce Operator Tree:":{"Merge Join Operator":{"keys:":{"1":"_col0 (type: varchar(20)), _col1 (type: date), _col2 (type: bigint), _col3 (type: int)","0":"_col7 (type: varchar(20)), _col5 (type: date), _col1 (type: bigint), _col2 (type: int)"},"outputColumnNames:":["_col7","_col16","_col17"],"children":{"Select Operator":{"expressions:":"_col16 (type: decimal(9,0)), _col17 (type: int), _col7 (type: varchar(20))","outputColumnNames:":["_col0","_col1","_col2"],"children":{"Reduce Output Operator":{"Map-reduce partition columns:":"_col0 (type: decimal(10,0)), _col1 (type: int)","sort order:":"++","value expressions:":"_col2 (type: varchar(20))","Statistics:":"Num rows: 886834 Data size: 102872810 Basic stats: COMPLETE Column stats: NONE","key expressions:":"_col0 (type: decimal(10,0)), _col1 (type: int)"}},"Statistics:":"Num rows: 886834 Data size: 102872810 Basic stats: COMPLETE Column stats: NONE"}},"Statistics:":"Num rows: 886834 Data size: 102872810 Basic stats: COMPLETE Column stats: NONE","condition map:":[{"":"Inner Join 0 to 1"}]}}},"Map 1":{"Map Operator Tree:":[{"TableScan":{"filterExpr:":"(id_prem is not null and id_spt is not null) (type: boolean)","alias:":"md_cisco_service_point","children":{"Filter Operator":{"predicate:":"(id_prem is not null and id_spt is not null) (type: boolean)","children":{"Select Operator":{"expressions:":"id_prem (type: decimal(9,0)), id_spt (type: int)","outputColumnNames:":["_col0","_col1"],"children":{"Reduce Output Operator":{"Map-reduce partition columns:":"_col0 (type: decimal(19,0)), _col1 (type: int)","sort order:":"++","value expressions:":"_col0 (type: decimal(9,0))","Statistics:":"Num rows: 732921 Data size: 85018849 Basic stats: COMPLETE Column stats: NONE","key expressions:":"_col0 (type: decimal(19,0)), _col1 (type: int)"}},"Statistics:":"Num rows: 732921 Data size: 85018849 Basic stats: COMPLETE Column stats: NONE"}},"Statistics:":"Num rows: 732921 Data size: 85018849 Basic stats: COMPLETE Column stats: NONE"}},"Statistics:":"Num rows: 2931684 Data size: 340075397 Basic stats: COMPLETE Column stats: NONE"}}]},"Map 10":{"Execution mode:":"vectorized","Map Operator Tree:":[{"TableScan":{"alias:":"tmp1_2","children":{"Reduce Output Operator":{"Map-reduce partition columns:":"CAST( id_prem AS decimal(10,0)) (type: decimal(10,0)), id_spt (type: int)","sort order:":"++","value expressions:":"id_prem (type: int), ad_hse_no (type: int), ad_hse_no_mod (type: varchar(3)), ad_str_nm (type: varchar(30)), ad_str_sx (type: varchar(4)), ad_svc_city (type: char(20)), ad_svc_st (type: char(2)), ad_svc_zip (type: int), ad_svc_zip_sx (type: int), ad_cross_st (type: varchar(30)), ad_crdnl_dir (type: char(2)), ad_dir_sx (type: char(2)), ad_modifier (type: char(5)), ad_svc_car_rte (type: char(4)), cd_brkr_loc (type: char(2)), id_x_coord (type: int), id_y_coord (type: int), cd_climate_zn (type: char(1)), cd_svc_typ (type: char(1)), cd_spt_typ (type: char(1)), cd_spt_stat_actual (type: char(1)), cd_spt_spec_use (type: char(2)), id_latitude (type: varchar(15)), id_longitude (type: varchar(15)), tx_cd_svc_typ (type: varchar(10))","Statistics:":"Num rows: 1000000 Data size: 1823000000 Basic stats: COMPLETE Column stats: NONE","key expressions:":"CAST( id_prem AS decimal(10,0)) (type: decimal(10,0)), id_spt (type: int)"}},"Statistics:":"Num rows: 1000000 Data size: 1823000000 Basic stats: COMPLETE Column stats: NONE"}}]},"Reducer 5":{"Reduce Operator Tree:":{"Merge Join Operator":{"keys:":{"1":"_col0 (type: decimal(10,0))","0":"CAST( _col0 AS decimal(10,0)) (type: decimal(10,0))"},"outputColumnNames:":["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7","_col8","_col9","_col10","_col11","_col12","_col13","_col14","_col15","_col16","_col17","_col19","_col20","_col21","_col22","_col23","_col24","_col25","_col26","_col32","_col35"],"children":{"Select Operator":{"expressions:":"_col0 (type: int), _col1 (type: int), _col2 (type: varchar(3)), _col3 (type: varchar(30)), _col4 (type: varchar(4)), _col5 (type: char(20)), _col6 (type: char(2)), _col7 (type: int), _col8 (type: int), _col9 (type: varchar(30)), _col10 (type: char(2)), _col11 (type: char(2)), _col12 (type: char(5)), _col13 (type: char(4)), _col14 (type: char(2)), _col15 (type: int), _col16 (type: int), _col17 (type: char(1)), concat(_col5, ', ', _col6, _col7, ', ', _col8, ', ', _col13, ', ', _col9) (type: string), _col19 (type: int), _col20 (type: char(1)), _col21 (type: char(1)), _col22 (type: char(1)), _col23 (type: char(2)), _col24 (type: varchar(15)), _col25 (type: varchar(15)), _col26 (type: varchar(10)), _col32 (type: varchar(20)), _col35 (type: string)","outputColumnNames:":["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7","_col8","_col9","_col10","_col11","_col12","_col13","_col14","_col15","_col16","_col17","_col18","_col19","_col20","_col21","_col22","_col23","_col24","_col25","_col26","_col27","_col28"],"children":{"File Output Operator":{"Statistics:":"Num rows: 1210000 Data size: 2205830095 Basic stats: COMPLETE Column stats: NONE","compressed:":"false","table:":{"serde:":"org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe","input format:":"org.apache.hadoop.mapred.TextInputFormat","output format:":"org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat"}}},"Statistics:":"Num rows: 1210000 Data size: 2205830095 Basic stats: COMPLETE Column stats: NONE"}},"Statistics:":"Num rows: 1210000 Data size: 2205830095 Basic stats: COMPLETE Column stats: NONE","condition map:":[{"":"Left Outer Join0 to 1"}]}}},"Reducer 4":{"Reduce Operator Tree:":{"Merge Join Operator":{"keys:":{"1":"_col0 (type: decimal(10,0)), _col1 (type: int)","0":"CAST( id_prem AS decimal(10,0)) (type: decimal(10,0)), id_spt (type: int)"},"outputColumnNames:":["_col0","_col1","_col2","_col3","_col4","_col5","_col6","_col7","_col8","_col9","_col10","_col11","_col12","_col13","_col14","_col15","_col16","_col17","_col19","_col20","_col21","_col22","_col23","_col24","_col25","_col26","_col32"],"children":{"Reduce Output Operator":{"Map-reduce partition columns:":"CAST( _col0 AS decimal(10,0)) (type: decimal(10,0))","sort order:":"+","value expressions:":"_col0 (type: int), _col1 (type: int), _col2 (type: varchar(3)), _col3 (type: varchar(30)), _col4 (type: varchar(4)), _col5 (type: char(20)), _col6 (type: char(2)), _col7 (type: int), _col8 (type: int), _col9 (type: varchar(30)), _col10 (type: char(2)), _col11 (type: char(2)), _col12 (type: char(5)), _col13 (type: char(4)), _col14 (type: char(2)), _col15 (type: int), _col16 (type: int), _col17 (type: char(1)), _col19 (type: int), _col20 (type: char(1)), _col21 (type: char(1)), _col22 (type: char(1)), _col23 (type: char(2)), _col24 (type: varchar(15)), _col25 (type: varchar(15)), _col26 (type: varchar(10)), _col32 (type: varchar(20))","Statistics:":"Num rows: 1100000 Data size: 2005300043 Basic stats: COMPLETE Column stats: NONE","key expressions:":"CAST( _col0 AS decimal(10,0)) (type: decimal(10,0))"}},"Statistics:":"Num rows: 1100000 Data size: 2005300043 Basic stats: COMPLETE Column stats: NONE","condition map:":[{"":"Left Outer Join0 to 1"}]}}},"Reducer 7":{"Execution mode:":"vectorized","Reduce Operator Tree:":{"Group By Operator":{"mode:":"mergepartial","aggregations:":["max(VALUE._col0)"],"keys:":"KEY._col0 (type: varchar(20)), KEY._col1 (type: bigint), KEY._col2 (type: int), KEY._col3 (type: date)","outputColumnNames:":["_col0","_col1","_col2","_col3","_col4"],"children":{"Select Operator":{"expressions:":"_col0 (type: varchar(20)), _col1 (type: bigint), _col2 (type: int), _col4 (type: date)","outputColumnNames:":["_col0","_col1","_col2","_col4"],"children":{"Filter Operator":{"predicate:":"_col4 is not null (type: boolean)","children":{"Select Operator":{"expressions:":"_col0 (type: varchar(20)), _col4 (type: date), _col1 (type: bigint), _col2 (type: int)","outputColumnNames:":["_col0","_col1","_col2","_col3"],"children":{"Reduce Output Operator":{"Map-reduce partition columns:":"_col0 (type: varchar(20)), _col1 (type: date), _col2 (type: bigint), _col3 (type: int)","sort order:":"++++","Statistics:":"Num rows: 394 Data size: 34680 Basic stats: COMPLETE Column stats: NONE","key expressions:":"_col0 (type: varchar(20)), _col1 (type: date), _col2 (type: bigint), _col3 (type: int)"}},"Statistics:":"Num rows: 394 Data size: 34680 Basic stats: COMPLETE Column stats: NONE"}},"Statistics:":"Num rows: 394 Data size: 34680 Basic stats: COMPLETE Column stats: NONE"}},"Statistics:":"Num rows: 394 Data size: 34680 Basic stats: COMPLETE Column stats: NONE"}},"Statistics:":"Num rows: 394 Data size: 34680 Basic stats: COMPLETE Column stats: NONE"}}},"Map 6":{"Map Operator Tree:":[{"TableScan":{"filterExpr:":"((cd_heat is not null and id_prem is not null) and id_spt is not null) (type: boolean)","alias:":"cisco_rate_change","children":{"Filter Operator":{"predicate:":"((cd_heat is not null and id_prem is not null) and id_spt is not null) (type: boolean)","children":{"Select Operator":{"expressions:":"cd_heat (type: varchar(20)), id_prem (type: bigint), id_spt (type: int), dt_term (type: date)","outputColumnNames:":["cd_heat","id_prem","id_spt","dt_term"],"children":{"Group By Operator":{"mode:":"hash","aggregations:":["max(dt_term)"],"keys:":"cd_heat (type: varchar(20)), id_prem (type: bigint), id_spt (type: int), dt_term (type: date)","outputColumnNames:":["_col0","_col1","_col2","_col3","_col4"],"children":{"Reduce Output Operator":{"Map-reduce partition columns:":"_col0 (type: varchar(20)), _col1 (type: bigint), _col2 (type: int), _col3 (type: date)","sort order:":"++++","value expressions:":"_col4 (type: date)","Statistics:":"Num rows: 788 Data size: 69361 Basic stats: COMPLETE Column stats: NONE","key expressions:":"_col0 (type: varchar(20)), _col1 (type: bigint), _col2 (type: int), _col3 (type: date)"}},"Statistics:":"Num rows: 788 Data size: 69361 Basic stats: COMPLETE Column stats: NONE"}},"Statistics:":"Num rows: 788 Data size: 69361 Basic stats: COMPLETE Column stats: NONE"}},"Statistics:":"Num rows: 788 Data size: 69361 Basic stats: COMPLETE Column stats: NONE"}},"Statistics:":"Num rows: 6298 Data size: 554361 Basic stats: COMPLETE Column stats: NONE"}}]},"Map 9":{"Map Operator Tree:":[{"TableScan":{"filterExpr:":"(processed_date > '\" + context.DA0001_LAST_RUN_DATE + \"') (type: boolean)","alias:":"md_cisco_premise_rural_location","children":{"Select Operator":{"expressions:":"id_prem (type: decimal(9,0)), tx_prem_dir (type: string)","outputColumnNames:":["_col0","_col1"],"children":{"Reduce Output Operator":{"Map-reduce partition columns:":"_col0 (type: decimal(10,0))","sort order:":"+","value expressions:":"_col1 (type: string)","Statistics:":"Num rows: 75772 Data size: 16063721 Basic stats: COMPLETE Column stats: NONE","key expressions:":"_col0 (type: decimal(10,0))"}},"Statistics:":"Num rows: 75772 Data size: 16063721 Basic stats: COMPLETE Column stats: NONE"}},"Statistics:":"Num rows: 75772 Data size: 16063721 Basic stats: COMPLETE Column stats: NONE"}}]},"Map 8":{"Map Operator Tree:":[{"TableScan":{"filterExpr:":"((((CAST( id_prem AS decimal(19,0)) is not null and id_spt is not null) and cd_heat is not null) and dt_term is not null) and id_prem is not null) (type: boolean)","alias:":"main","children":{"Filter Operator":{"predicate:":"((((CAST( id_prem AS decimal(19,0)) is not null and id_spt is not null) and cd_heat is not null) and dt_term is not null) and id_prem is not null) (type: boolean)","children":{"Reduce Output Operator":{"Map-reduce partition columns:":"CAST( id_prem AS decimal(19,0)) (type: decimal(19,0)), id_spt (type: int)","sort order:":"++","value expressions:":"id_prem (type: bigint), dt_term (type: date), cd_heat (type: varchar(20))","Statistics:":"Num rows: 197 Data size: 17340 Basic stats: COMPLETE Column stats: NONE","key expressions:":"CAST( id_prem AS decimal(19,0)) (type: decimal(19,0)), id_spt (type: int)"}},"Statistics:":"Num rows: 197 Data size: 17340 Basic stats: COMPLETE Column stats: NONE"}},"Statistics:":"Num rows: 6298 Data size: 554361 Basic stats: COMPLETE Column stats: NONE"}}]}},"Edges:":{"Reducer 2":[{"parent":"Map 1","type":"SIMPLE_EDGE"},{"parent":"Map 8","type":"SIMPLE_EDGE"}],"Reducer 3":[{"parent":"Reducer 2","type":"SIMPLE_EDGE"},{"parent":"Reducer 7","type":"SIMPLE_EDGE"}],"Reducer 5":[{"parent":"Map 9","type":"SIMPLE_EDGE"},{"parent":"Reducer 4","type":"SIMPLE_EDGE"}],"Reducer 4":[{"parent":"Map 10","type":"SIMPLE_EDGE"},{"parent":"Reducer 3","type":"SIMPLE_EDGE"}],"Reducer 7":{"parent":"Map 6","type":"SIMPLE_EDGE"}}}},"Stage-0":{"Fetch Operator":{"limit:":"-1","Processor Tree:":{"ListSink":{}}}}},"STAGE DEPENDENCIES":{"Stage-1":{"ROOT STAGE":"TRUE"},"Stage-0":{"DEPENDENT STAGES":"Stage-1"}}}
